(self.webpackChunkdocusaurus_code=self.webpackChunkdocusaurus_code||[]).push([[5747],{64938:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return a.createSvgIcon}});var a=n(33875)},33875:(e,t,n)=>{"use strict";n.r(t),n.d(t,{capitalize:()=>i.Z,createChainedFunction:()=>o,createSvgIcon:()=>r.Z,debounce:()=>l.Z,deprecatedPropType:()=>s,isMuiElement:()=>c.Z,ownerDocument:()=>u.Z,ownerWindow:()=>d.Z,requirePropFactory:()=>m,setRef:()=>p,unstable_ClassNameGenerator:()=>C,unstable_useEnhancedEffect:()=>k.Z,unstable_useId:()=>v,unsupportedProp:()=>g,useControlled:()=>h.Z,useEventCallback:()=>b.Z,useForkRef:()=>Z.Z,useIsFocusVisible:()=>f.Z});var a=n(37078),i=n(98216);const o=n(49064).Z;var r=n(88169),l=n(57144);const s=function(e,t){return()=>null};var c=n(71579),u=n(8038),d=n(5340);n(83117);const m=function(e,t){return()=>null};const p=n(7960).Z;var k=n(58974);const v=n(92996).Z;const g=function(e,t,n,a,i){return null};var h=n(72021),b=n(2068),Z=n(51705),f=n(18791);const C={configure:e=>{a.Z.configure(e)}}},86153:(e,t,n)=>{"use strict";n.d(t,{_:()=>_});var a=n(67294),i=n(87357),o=n(83321),r=n(61903),l=n(23599),s=n(86886),c=n(67720),u=n(90629),d=n(7906),m=n(295),p=n(53252),k=n(72882),v=n(53184),g=n(53816),h=n(24661),b=n(96540),Z=n(93946),f=n(41733),C=n(50657),y=n(31425),S=n(6514),N=n(58951),E=n(37645),I=n(52263),x=n(59457),B=n(53143);const _=(0,a.memo)((()=>{const{i18n:e}=(0,I.Z)(),t=(0,B.S)(),n=(0,a.useMemo)((()=>t?T:w),[t]),_=(0,a.useMemo)((()=>{const e=new Map;for(const t of n)e.set(t.id,t);return e}),[n]),M=(0,a.useMemo)((()=>t?q:P),[t]),j=(0,a.useMemo)((()=>{const e=new Map;for(const t of M)e.set(t.id,t);return e}),[M]),[A,z]=(0,x.x)((()=>({userId:1,province:_.get(1).province,city:_.get(1).city,address:_.get(1).address,items:[{__rowId:1,productId:1,name:j.get(1).name,quantity:2},{__rowId:2,productId:10,name:j.get(10).name,quantity:1}]}))),W=(0,a.useMemo)((()=>Math.max(...A.items.map((e=>e.__rowId)))+1),[A]),D=(0,a.useCallback)((e=>{const t=_.get(parseInt(e.target.value));void 0!==t&&z((e=>{e.userId=t.id,e.province=t.province,e.city=t.city,e.address=t.address}))}),[z,_]),O=(0,a.useCallback)((e=>{z((t=>{t.province=e.target.value}))}),[z]),F=(0,a.useCallback)((e=>{z((t=>{t.city=e.target.value}))}),[z]),R=(0,a.useCallback)((e=>{z((t=>{t.address=e.target.value}))}),[z]),J=(0,a.useCallback)(((e,t)=>{z((n=>{for(const a of n.items)if(a.__rowId===t){a.productId=parseInt(e.target.value),L(n);break}}))}),[z]),G=(0,a.useCallback)(((e,t)=>{z((n=>{for(const a of n.items)if(a.__rowId===t){a.quantity=parseInt(e.target.value),L(n);break}}))}),[z]),U=(0,a.useCallback)((e=>{z((t=>{for(let n=t.items.length-1;n>=0;--n)if(t.items[n].__rowId===e){t.items.splice(n,1);break}}))}),[z]),K=(0,a.useCallback)((()=>{z((e=>{e.items.push({__rowId:W,quantity:1})}))}),[z,W]),[V,X]=(0,a.useState)(!1),H=(0,a.useCallback)((()=>{X(!0)}),[]),Q=(0,a.useCallback)((()=>{X(!1)}),[]);return a.createElement(u.Z,{elevation:3,style:{padding:"1.5rem"}},a.createElement(i.Z,{component:"form",noValidate:!0,autoComplete:"off"},a.createElement(s.ZP,{container:!0,spacing:2},a.createElement(s.ZP,{item:!0,xs:4},a.createElement(r.Z,{fullWidth:!0,select:!0,label:t?"\u8d2d\u4e70\u4eba":"Purchaser",value:A.userId,onChange:D},n.map((e=>a.createElement(l.Z,{key:e.id,value:e.id},e.nickName))))),a.createElement(s.ZP,{item:!0,xs:4},a.createElement(r.Z,{fullWidth:!0,label:t?"\u7701\u4efd":"Province",value:A.province,onChange:O})),a.createElement(s.ZP,{item:!0,xs:4},a.createElement(r.Z,{fullWidth:!0,label:t?"\u57ce\u5e02":"City",value:A.city,onChange:F})),a.createElement(s.ZP,{item:!0,xs:12},a.createElement(r.Z,{fullWidth:!0,label:t?"\u5730\u5740":"Address",value:A.address,onChange:R})),a.createElement(s.ZP,{item:!0,xs:12},a.createElement(c.Z,{textAlign:"left"},t?"\u8ba2\u5355\u660e\u7ec6":"Order Items"),a.createElement(k.Z,{component:u.Z},a.createElement(d.Z,{size:"small"},a.createElement(v.Z,null,a.createElement(g.Z,null,a.createElement(p.Z,null,t?"\u5546\u54c1":"Commodity"),a.createElement(p.Z,null,t?"\u6570\u91cf":"Quantity"),a.createElement(p.Z,null,t?"\u5355\u4ef7":"Unit price"),a.createElement(p.Z,null,t?"\u660e\u7ec6\u4ef7":"Item price"),a.createElement(p.Z,null,t?"\u5220\u9664":"Delete"))),a.createElement(m.Z,null,A.items.map((e=>{const t=void 0!==e.productId?j.get(e.productId):void 0;return a.createElement(g.Z,{key:e.__rowId},a.createElement(p.Z,null,a.createElement(r.Z,{select:!0,value:null==t?void 0:t.id,variant:"standard",size:"small",onChange:t=>{J(t,e.__rowId)}},M.map((e=>a.createElement(l.Z,{key:e.id,value:e.id},e.name))))),a.createElement(p.Z,null,a.createElement(r.Z,{type:"number",value:e.quantity,variant:"standard",size:"small",onChange:t=>{G(t,e.__rowId)}})),a.createElement(p.Z,null,null==t?void 0:t.price),a.createElement(p.Z,null,void 0!==t&&t.price*e.quantity),a.createElement(p.Z,null,a.createElement(Z.Z,{onClick:()=>U(e.__rowId)},a.createElement(f.Z,null))))}))),a.createElement(h.Z,null,a.createElement(g.Z,null,a.createElement(p.Z,{colSpan:5},a.createElement(o.Z,{onClick:K},a.createElement(b.Z,null),t?"\u6dfb\u52a0":"Add"))))))),a.createElement(s.ZP,{item:!0,xs:12},t?"\u603b\u989d":"Total price",":",A.items.filter((e=>void 0!==e.productId&&"number"==typeof e.quantity)).map((e=>j.get(e.productId).price*e.quantity)).reduce(((e,t)=>e+t),0)),a.createElement(s.ZP,{item:!0,xs:12},a.createElement(o.Z,{variant:"contained",onClick:H},t?"\u63d0\u4ea4":"Submit")))),a.createElement(C.Z,{open:V,onClose:Q},a.createElement(E.Z,null,t?"\u4fe1\u606f":"Info"),a.createElement(S.Z,null,a.createElement(N.Z,null,t?"\u4ec5\u4f5c\u793a\u8303\uff0c\u65e0\u4efb\u4f55\u6548\u679c":"For demonstration only, without any effect")),a.createElement(y.Z,null,a.createElement(o.Z,{onClick:Q},t?"\u5173\u95ed":"Close"))))})),T=[{id:1,nickName:"\u76ae\u76ae\u9c81",province:"\u56db\u5ddd",city:"\u6210\u90fd",address:"\u9f99\u6cc9\u9a7f\u533a\u6d2a\u7389\u8def\u4e0e\u5341\u6d2a\u8def\u4ea4\u53c9\u53e3"},{id:2,nickName:"\u9c81\u897f\u897f",province:"\u5e7f\u4e1c",city:"\u5e7f\u5dde",address:"\u767d\u4e91\u533a\u77f3\u6c99\u8def300\u53f7"},{id:3,nickName:"\u8212\u514b",province:"\u897f\u85cf",city:"\u62c9\u8428",address:"\u5806\u9f99\u5fb7\u5e86\u533a"},{id:4,nickName:"\u8d1d\u5854",province:"\u4e0a\u6d77",city:"\u4e0a\u6d77",address:"\u6d66\u4e1c\u65b0\u533a\u79c0\u6cbf\u897f\u8def218\u5f04"}],w=[{id:1,nickName:"Schneewittchen",province:"Berlin",city:"Prenzlauer Berg",address:"Brandenburgische Stra\xdfe 9, Prenzlauer Berg, Berlin, Germany"},{id:2,nickName:"Cinderella",province:"Basse-Normandie",city:"Lisieux",address:"20 rue L\xe9on Dierx, Lisieux, Basse-Normandie, France"},{id:3,nickName:"Nuwa",province:"ShanXi",city:"Taiyuan",address:"Qian Feng Nan Lu 99hao, Taiyuan, ShanXi, China"},{id:4,nickName:"Pinocchio",province:"Palazzo Pignano",city:"Cremona",address:"Via Giovanni Amendola 134, Palazzo Pignano, Cremona, Italy"}],q=[{id:1,name:"zippo\u591c\u5149\u6d41\u6c99\u6253\u706b\u673a",price:268},{id:2,name:"\u6770\u767b(Jayden)\u5370\u5ea6\u5854\u5e03\u62c9\u9f13",price:9238},{id:3,name:"\u6d6a\u7434(Longines)\u673a\u68b0\u624b\u8868",price:13900},{id:4,name:"viney\u7537\u58eb\u76ae\u5e26",price:139},{id:5,name:"\u96c5\u8bd7\u5170\u9edb\u7ed2\u96fe\u54d1\u5149\u5507\u818f",price:310},{id:6,name:"CIRCUIT\u7537\u5b50\u6ed1\u96ea\u5355\u677f",price:2044},{id:7,name:"\u7279\u4ed1\u82cf\u8131\u8102\u725b\u5976",price:47},{id:8,name:"\u4e50\u9ad8\u79ef\u6728\u5e03\u52a0\u8fea",price:374},{id:9,name:"\u53cc\u559c\u71c3\u6c14\u7535\u78c1\u901a\u7528\u538b\u529b\u9505",price:137},{id:10,name:"\u61a8\u61a8\u5ba0\u732b\u722c\u67b6",price:238}],P=[{id:1,name:"Timeless Vitamin C Plus E 10 Percent Ferulic Acid Serum Serum Unisex 1 oz",price:14.69},{id:2,name:"Dockers Men's Tiller Boat Shoe",price:52.41},{id:3,name:"Paxcoo 124 Skeins Embroidery Floss Cross Stitch Thread with Needles",price:29.99},{id:4,name:"Michael Kors Crossbody",price:70.6},{id:5,name:"Crocs unisex-child Classic Graphic Clog",price:34.99},{id:6,name:"Timex Time Machines Digital 35mm Watch",price:28.95},{id:7,name:"Scalex Mite & Lice Spray for Birds, 8 oz.",price:14.75},{id:8,name:"Under Armour Men's Storm Liner",price:13.03},{id:9,name:"Nike Women's Pro 3\" Training Shorts",price:35.86},{id:10,name:"Olaplex No. 4 Bond Maintenance Shampoo",price:30}];function L(e){const t=e.items,n=new Map;for(let a=0;a<t.length;a++){const e=t[a];if("number"!=typeof e.quantity)e.quantity=1;else if(e.quantity<1){t.splice(a--,1);continue}if(void 0===e.productId)continue;const i=n.get(e.productId);void 0===i?n.set(e.productId,e):(i.quantity+=e.quantity,t.splice(a--,1))}}},53143:(e,t,n)=>{"use strict";n.d(t,{S:()=>i});var a=n(52263);function i(){const{i18n:e}=(0,a.Z)(),t=e.currentLocale;return"zh"===t||"zh_cn"===t||"zh_CN"==t}},45363:(e,t,n)=>{"use strict";n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>c,default:()=>k,frontMatter:()=>s,metadata:()=>u,toc:()=>m});var a=n(83117),i=(n(67294),n(3905)),o=n(65488),r=n(85162),l=n(86153);const s={sidebar_position:3,title:"\u4fdd\u5b58\u957f\u5173\u8054"},c=void 0,u={unversionedId:"quick-view/save/export/long",id:"quick-view/save/export/long",title:"\u4fdd\u5b58\u957f\u5173\u8054",description:"\u4f55\u8c13\u77ed\u5173\u8054",source:"@site/i18n/zh/docusaurus-plugin-content-docs/current/quick-view/save/export/long.mdx",sourceDirName:"quick-view/save/export",slug:"/quick-view/save/export/long",permalink:"/jimmer-doc/zh/docs/quick-view/save/export/long",draft:!1,editUrl:"https://github.com/babyfish-ct/jimmer-doc/tree/main/docs/quick-view/save/export/long.mdx",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,title:"\u4fdd\u5b58\u957f\u5173\u8054"},sidebar:"tutorialSidebar",previous:{title:"\u4fdd\u5b58\u77ed\u5173\u8054",permalink:"/jimmer-doc/zh/docs/quick-view/save/export/short"},next:{title:"3. \u4efb\u610f\u52a8\u6001\u67e5\u8be2",permalink:"/jimmer-doc/zh/docs/quick-view/dsl/"}},d={},m=[{value:"\u4f55\u8c13\u77ed\u5173\u8054",id:"\u4f55\u8c13\u77ed\u5173\u8054",level:2},{value:"\u7f16\u5199DTO",id:"\u7f16\u5199dto",level:2},{value:"\u751f\u6210\u7684\u4ee3\u7801",id:"\u751f\u6210\u7684\u4ee3\u7801",level:2},{value:"\u7f16\u5199HTTP\u670d\u52a1",id:"\u7f16\u5199http\u670d\u52a1",level:2}],p={toc:m};function k(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"\u4f55\u8c13\u77ed\u5173\u8054"},"\u4f55\u8c13\u77ed\u5173\u8054"),(0,i.kt)("p",null,"\u6240\u8c13\u957f\u5173\u8054\uff0c\u6307\u4e0d\u4ec5\u8981\u6539\u53d8\u5f53\u524d\u5bf9\u8c61\u548c\u5176\u4ed6\u5bf9\u8c61\u4e4b\u95f4\u7684\u5173\u8054\u5173\u7cfb\uff0c\u8fd8\u8981\u8fdb\u4e00\u6b65\u4fee\u6539\u5173\u8054\u5bf9\u8c61\u3002"),(0,i.kt)("p",null,"\u5bf9\u4e8eUI\u754c\u9762\u800c\u8a00\uff0c\u901a\u5e38\u8868\u73b0\u4e3a\u7236\u5b50\u8868\u5355\u7684\u5d4c\u5957 ",(0,i.kt)("em",{parentName:"p"},"(\u751a\u81f3\u6811\u5f62\u9012\u5f52)"),"\u3002\u5f62\u5f0f\u591a\u6837\uff0c\u4ee5\u8868\u5355\u5185\u5d4c\u5b50\u8868\u9887\u4e3a\u5e38\u89c1\uff0c\u5982\u4e0b\uff1a"),(0,i.kt)(l._,{mdxType:"LongAssociation"}),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"\u53ea\u8981\u5f00\u53d1\u4eba\u5458\u613f\u610f\uff0c\u8fd9\u79cd\u7236\u5b50\u8868\u5355\u5d4c\u5957\u7ed3\u6784\u7684\u6df1\u5ea6\u53ef\u4ee5\u4e0d\u53ea\u4e24\u5c42\uff0c\u4ece\u7406\u8bba\u4e0a\u8bb2\uff0c\u6df1\u5ea6\u53ef\u4ee5\u65e0\u9650\uff0c\u8fd9\u5c31\u662f\u79f0\u5176\u4e3a\u957f\u5173\u8054\u7684\u539f\u56e0\u3002")),(0,i.kt)("h2",{id:"\u7f16\u5199dto"},"\u7f16\u5199DTO"),(0,i.kt)("p",null,"\u5728\u5f53\u524d\u4f8b\u5b50\u7684\u5728",(0,i.kt)("a",{parentName:"p",href:"../../precondition#book"},"\u5b9e\u4f53\u5b9a\u4e49"),"\u4e2d\uff0c\u6bd4\u8f83\u9002\u5408\u4f5c\u4e3a\u957f\u5173\u8054\u7684\u4f8b\u5b50\u662f\u4fdd\u5b58",(0,i.kt)("inlineCode",{parentName:"p"},"BookStore"),"\u4ee5\u53ca\u5b83\u7684",(0,i.kt)("inlineCode",{parentName:"p"},"books"),"\u5173\u8054\u96c6\u5408\u3002"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"\u5b89\u88c5DTO\u8bed\u8a00Intellij\u63d2\u4ef6\uff1a",(0,i.kt)("a",{parentName:"p",href:"https://github.com/ClearPlume/jimmer-dto"},"https://github.com/ClearPlume/jimmer-dto")," ",(0,i.kt)("em",{parentName:"p"},"\uff08\u6b64\u8fc7\u7a0b\u4e0d\u662f\u5fc5\u987b\u7684\uff0c\u4f46\u975e\u5e38\u63a8\u8350\uff09"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"\u65b0\u5efa\u76ee\u5f55",(0,i.kt)("inlineCode",{parentName:"p"},"src/main/dto"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"\u5728",(0,i.kt)("inlineCode",{parentName:"p"},"src/main/dto"),"\u4e0b\u5efa\u7acb\u4e00\u4e2a\u6587\u4ef6",(0,i.kt)("inlineCode",{parentName:"p"},"BookStore.dto"),"\uff0c\u7f16\u5199\u4ee3\u7801\u5982\u4e0b"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-sh",metastring:'title="BookStore.dto"',title:'"BookStore.dto"'},"export org.doc.j.model.BookStore\n    -> package org.doc.j.model.dto\n\ninput BookStoreWithLongAssociation {\n    #allScalars(this)\n    #highlight-next-line\n    books { // LongAssociation\n        #allScalars(this)\n        -id\n        id(authors) as authorIds\n    }\n}\n")))),(0,i.kt)("h2",{id:"\u751f\u6210\u7684\u4ee3\u7801"},"\u751f\u6210\u7684\u4ee3\u7801"),(0,i.kt)("p",null,"\u7f16\u8bd1\uff0cJimmer\u4f1a\u751f\u6210\u5982\u4e0b\u4ee3\u7801"),(0,i.kt)(o.Z,{groupId:"language",mdxType:"Tabs"},(0,i.kt)(r.Z,{value:"java",label:"Java",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java",metastring:'title="BookStoreWithLongAssociation.java"',title:'"BookStoreWithLongAssociation.java"'},'@GeneratedBy(\n        file = "<yourproject>/src/main/dto/BookStore.dto"\n)\npublic class BookStoreWithLongAssociation implements Input<BookStore> {\n\n    @Nullable\n    private Long id;\n\n    @NotNull\n    private String name;\n\n    @Nullable\n    private String website;\n\n    @NotNull\n    // highlight-next-line\n    private List<TargetOf_books> books;\n\n    ...\u7701\u7565\u5176\u4ed6\u65b9\u6cd5...\n\n    public static class TargetOf_books implements Input<Book> {\n\n        @NotNull\n        private String name;\n\n        private int edition;\n\n        @NotNull\n        private BigDecimal price;\n\n        @NotNull\n        private List<Long> authorIds;\n\n        ...\u7701\u7565\u5176\u4ed6\u65b9\u6cd5...\n    }\n}\n'))),(0,i.kt)(r.Z,{value:"kotlin",label:"Kotlin",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-kotlin",metastring:'title="BookStoreWithLongAssociation.kt"',title:'"BookStoreWithLongAssociation.kt"'},'@GeneratedBy(\n        file = "<yourproject>/src/main/dto/BookStore.dto"\n)\ndata class BookStoreWithLongAssociation(\n    val id: Long?\n    val name: String,\n    val website: String?,\n    // highlight-next-line\n    val books: List<TargetOf_books>\n) : Input<BookStore> {\n    \n    ...\u7701\u7565\u5176\u4ed6\u65b9\u6cd5...\n\n    data class TargetOf_authors(\n        val name: String,\n        val edition: Int,\n        val price: BigDecimal,\n        val authorIds: List<Long>\n    )\n}\n')))),(0,i.kt)("h2",{id:"\u7f16\u5199http\u670d\u52a1"},"\u7f16\u5199HTTP\u670d\u52a1"),(0,i.kt)(o.Z,{groupId:"language",mdxType:"Tabs"},(0,i.kt)(r.Z,{value:"java",label:"Java",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java",metastring:'title="BookStoreController.java"',title:'"BookStoreController.java"'},'@RestController\npublic class BookStoreController {\n\n    private final JSqlClient sqlClient;\n\n    public BookController(JSqlClient sqlClient) {\n        this.sqlClient = sqlClient;\n    } \n\n    @PutMapping("/bookStore")\n    pubic int saveBookStoreWithLongAssociation(\n        // highlight-next-line\n        @RequestBody BookStoreWithLongAssociation input\n    ) {\n        return sqlClient\n            .save(input)\n            .getTotoalAffectedRowCount();\n    }\n}\n'))),(0,i.kt)(r.Z,{value:"kotlin",label:"Kotlin",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-kotlin",metastring:'title="BookStoreController.java"',title:'"BookStoreController.java"'},'class BookStoreController(\n    private val sqlClient: KSqlClient\n) {\n\n    @PutMapping("/bookStore")\n    fun saveBookStoreWithLongAssociation(\n        // highlight-next-line\n        @RequestBody input: BookStoreWithLongAssociation\n    ): Int =\n        sqlClient\n            .save(input)\n            .totoalAffectedRowCount\n}\n')))),(0,i.kt)("p",null,"\u53ef\u89c1\uff0c\u65e0\u8bbaInput DTO\u5982\u4f55\u6539\u53d8\uff0cJimmer\u4ecd\u7136\u53ea\u9700\u4e00\u4e2a\u65b9\u6cd5\u8c03\u7528\u5373\u53ef\u5b8c\u6210\u6570\u636e\u4fdd\u5b58\u3002"))}k.isMDXComponent=!0},66344:e=>{e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports}}]);