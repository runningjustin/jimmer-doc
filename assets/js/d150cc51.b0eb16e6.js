"use strict";(self.webpackChunkdocusaurus_code=self.webpackChunkdocusaurus_code||[]).push([[7941],{3905:(e,t,n)=>{n.d(t,{Zo:()=>s,kt:()=>c});var a=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var p=a.createContext({}),u=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},s=function(e){var t=u(e.components);return a.createElement(p.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,p=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),m=u(n),c=o,k=m["".concat(p,".").concat(c)]||m[c]||d[c]||i;return n?a.createElement(k,r(r({ref:t},s),{},{components:n})):a.createElement(k,r({ref:t},s))}));function c(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,r=new Array(i);r[0]=m;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:o,r[1]=l;for(var u=2;u<i;u++)r[u]=n[u];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},85162:(e,t,n)=>{n.d(t,{Z:()=>r});var a=n(67294),o=n(34334);const i="tabItem_Ymn6";function r(e){let{children:t,hidden:n,className:r}=e;return a.createElement("div",{role:"tabpanel",className:(0,o.Z)(i,r),hidden:n},t)}},65488:(e,t,n)=>{n.d(t,{Z:()=>c});var a=n(83117),o=n(67294),i=n(34334),r=n(72389),l=n(67392),p=n(7094),u=n(12466);const s="tabList__CuJ",d="tabItem_LNqP";function m(e){var t;const{lazy:n,block:r,defaultValue:m,values:c,groupId:k,className:h}=e,g=o.Children.map(e.children,(e=>{if((0,o.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),v=c??g.map((e=>{let{props:{value:t,label:n,attributes:a}}=e;return{value:t,label:n,attributes:a}})),b=(0,l.l)(v,((e,t)=>e.value===t.value));if(b.length>0)throw new Error(`Docusaurus error: Duplicate values "${b.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);const f=null===m?m:m??(null==(t=g.find((e=>e.props.default)))?void 0:t.props.value)??g[0].props.value;if(null!==f&&!v.some((e=>e.value===f)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${f}" but none of its children has the corresponding value. Available values are: ${v.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:y,setTabGroupChoices:N}=(0,p.U)(),[I,C]=(0,o.useState)(f),T=[],{blockElementScrollPositionUntilNextRender:B}=(0,u.o5)();if(null!=k){const e=y[k];null!=e&&e!==I&&v.some((t=>t.value===e))&&C(e)}const O=e=>{const t=e.currentTarget,n=T.indexOf(t),a=v[n].value;a!==I&&(B(t),C(a),null!=k&&N(k,String(a)))},w=e=>{var t;let n=null;switch(e.key){case"ArrowRight":{const t=T.indexOf(e.currentTarget)+1;n=T[t]??T[0];break}case"ArrowLeft":{const t=T.indexOf(e.currentTarget)-1;n=T[t]??T[T.length-1];break}}null==(t=n)||t.focus()};return o.createElement("div",{className:(0,i.Z)("tabs-container",s)},o.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.Z)("tabs",{"tabs--block":r},h)},v.map((e=>{let{value:t,label:n,attributes:r}=e;return o.createElement("li",(0,a.Z)({role:"tab",tabIndex:I===t?0:-1,"aria-selected":I===t,key:t,ref:e=>T.push(e),onKeyDown:w,onFocus:O,onClick:O},r,{className:(0,i.Z)("tabs__item",d,null==r?void 0:r.className,{"tabs__item--active":I===t})}),n??t)}))),n?(0,o.cloneElement)(g.filter((e=>e.props.value===I))[0],{className:"margin-top--md"}):o.createElement("div",{className:"margin-top--md"},g.map(((e,t)=>(0,o.cloneElement)(e,{key:t,hidden:e.props.value!==I})))))}function c(e){const t=(0,r.Z)();return o.createElement(m,(0,a.Z)({key:String(t)},e))}},67963:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>p,default:()=>c,frontMatter:()=>l,metadata:()=>u,toc:()=>d});var a=n(83117),o=(n(67294),n(3905)),i=n(65488),r=n(85162);const l={sidebar_position:1,title:"Save Aggregate Root"},p=void 0,u={unversionedId:"quick-view/save/export/root",id:"quick-view/save/export/root",title:"Save Aggregate Root",description:"Overview",source:"@site/docs/quick-view/save/export/root.mdx",sourceDirName:"quick-view/save/export",slug:"/quick-view/save/export/root",permalink:"/jimmer-doc/docs/quick-view/save/export/root",draft:!1,editUrl:"https://github.com/babyfish-ct/jimmer-doc/tree/main/docs/quick-view/save/export/root.mdx",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,title:"Save Aggregate Root"},sidebar:"tutorialSidebar",previous:{title:"Exposing Features",permalink:"/jimmer-doc/docs/quick-view/save/export/"},next:{title:"Save Short Associations",permalink:"/jimmer-doc/docs/quick-view/save/export/short"}},s={},d=[{value:"Overview",id:"overview",level:2},{value:"Homogeneous Change Scenario",id:"homogeneous-change-scenario",level:2},{value:"Define Input DTO",id:"define-input-dto",level:3},{value:"Generated Code",id:"generated-code",level:3},{value:"Write HTTP Service",id:"write-http-service",level:3},{value:"Heterogeneous Change Scenario",id:"heterogeneous-change-scenario",level:2},{value:"Requirements",id:"requirements",level:3},{value:"Write DTO",id:"write-dto",level:3},{value:"Generated Code",id:"generated-code-1",level:3},{value:"Write HTTP Service",id:"write-http-service-1",level:3}],m={toc:d};function c(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"overview"},"Overview"),(0,o.kt)("p",null,"Although Jimmer's data saving capability is designed for arbitrary complex data structures, in order to show how to safely expose the data saving capability step by step, this article only discusses saving a single object, and saving complex data structures will be described in subsequent articles.  "),(0,o.kt)("p",null,"For more practical guidance, this article discusses two situations:  "),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Homogeneous change scenario:  "),(0,o.kt)("p",{parentName:"li"},"This is a relatively simple business scenario where the form structure of the ",(0,o.kt)("inlineCode",{parentName:"p"},"INSERT")," operation and the ",(0,o.kt)("inlineCode",{parentName:"p"},"UPDATE")," operation is consistent.  ")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Heterogeneous change scenario:   "),(0,o.kt)("p",{parentName:"li"},"This is a relatively complex business scenario where the form structures of the ",(0,o.kt)("inlineCode",{parentName:"p"},"INSERT")," operation and the ",(0,o.kt)("inlineCode",{parentName:"p"},"UPDATE")," operation are inconsistent.  "))),(0,o.kt)("p",null,"In addition, since the save directive only requires one function call, encapsulating it with ",(0,o.kt)("inlineCode",{parentName:"p"},"Repository")," does not make much sense. In order to simplify unnecessary complexity, this article no longer defines ",(0,o.kt)("inlineCode",{parentName:"p"},"Repository"),", but lets ",(0,o.kt)("inlineCode",{parentName:"p"},"Controller")," use ",(0,o.kt)("inlineCode",{parentName:"p"},"sqlClient")," directly.  "),(0,o.kt)("h2",{id:"homogeneous-change-scenario"},"Homogeneous Change Scenario"),(0,o.kt)("h3",{id:"define-input-dto"},"Define Input DTO"),(0,o.kt)("p",null,"Since we have some understanding of the DTO language in ",(0,o.kt)("a",{parentName:"p",href:"../../fetch/export/dto"},"Query Arbitrary Shape/Exposing Features/Return Output DTO"),", this article will not repeat the discussion.  "),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Install DTO language Intellij plugin: ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/ClearPlume/jimmer-dto"},"https://github.com/ClearPlume/jimmer-dto")," ",(0,o.kt)("em",{parentName:"p"},"(This process is not required but highly recommended)"),"  ")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Create a new directory ",(0,o.kt)("inlineCode",{parentName:"p"},"src/main/dto"),"  ")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Under ",(0,o.kt)("inlineCode",{parentName:"p"},"src/main/dto"),", create a file ",(0,o.kt)("inlineCode",{parentName:"p"},"Book.dto")," and write the following code:  "),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-sh",metastring:'title="Book.dto"',title:'"Book.dto"'},"export com.yourcompany.yourproject.model.Book\n    -> package com.yourcompany.yourproject.model.dto  \n\n#highlight-next-line\ninput BookInput {\n    #allScalars(this) \n}  \n...Omit other DTO definitions...\n")),(0,o.kt)("admonition",{parentName:"li",type:"info"},(0,o.kt)("p",{parentName:"admonition"},"Unlike the Output DTO in ",(0,o.kt)("a",{parentName:"p",href:"../../fetch/export/dto"},"Query Arbitrary Shape/Exposing Features"),", the input DTO here uses the ",(0,o.kt)("inlineCode",{parentName:"p"},"input")," modifier  ")))),(0,o.kt)("h3",{id:"generated-code"},"Generated Code"),(0,o.kt)("p",null,"After compilation, Jimmer will automatically generate the following types:  "),(0,o.kt)(i.Z,{groupId:"language",mdxType:"Tabs"},(0,o.kt)(r.Z,{value:"java",label:"Java",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java",metastring:'title="BookInput.java"',title:'"BookInput.java"'},'@GeneratedBy( \u2776\n    file = "<yourproject>/src/main/dto/Book.dto"  \n)\npublic class BookInput implements Input<Book> { \u2777\n\n    // highlight-next-line\n    @Nullable \u2778 \n    private Long id;\n\n    @NotNull\n    private String name;\n\n    private int edition;\n\n    @NotNull\n    private BigDecimal price;\n\n    public BookInput(@NotNull Book base) { \u2779\n        ...omitted... \n    }\n\n    @Override  \n    public Book toEntity() { \u277a\n        ...omitted...\n    }\n\n    ...Omit other members...\n}\n'))),(0,o.kt)(r.Z,{value:"kotlin",label:"Kotlin",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-kotlin",metastring:'title="BookInput.kt"',title:'"BookInput.kt"'},'@GeneratedBy( \u2776\n    file = "<yourproject>/src/main/dto/Book.dto"  \n)\ndata class BookInput(\n    // highlight-next-line \n    id: Long?, \u2778\n    name: String,\n    edition: Int, \n    price: BigDecimal  \n) : Input<Book> { \u2777\n\n    constructor(base: Book): \u2779\n        this(...)  \n\n    override fun toEntity(): Book = \u277a\n        ...  \n}\n')))),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u2776 Remind developers that this class is automatically generated by Jimmer  ")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u2777 Unlike the Output DTO in ",(0,o.kt)("a",{parentName:"p",href:"../../fetch/export/dto"},"Query Arbitrary Shape/Exposing Features/Return Output DTO"),", after using the ",(0,o.kt)("inlineCode",{parentName:"p"},"input")," modifier in the DTO language, the generated class will implement the ",(0,o.kt)("inlineCode",{parentName:"p"},"Input<Book>")," interface instead of the ",(0,o.kt)("inlineCode",{parentName:"p"},"View<Book>")," interface.   ")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u2778 If an auto increment strategy (such as automatic change, sequence, UUID, snowflake ID) is configured for the ",(0,o.kt)("inlineCode",{parentName:"p"},"id")," attribute of the original entity, using the ",(0,o.kt)("inlineCode",{parentName:"p"},"input")," modifier in the DTO language will cause the id attribute of the DTO to be null.  "),(0,o.kt)("p",{parentName:"li"},"The final DTO object will be converted to an entity object through \u277a and then saved by Jimmer. If the id attribute of the DTO is null, then after conversion to the entity, the id attribute of the entity will be in an unspecified state.  "),(0,o.kt)("p",{parentName:"li"},"For save operations that do not explicitly specify ",(0,o.kt)("inlineCode",{parentName:"p"},"INSERT")," mode or ",(0,o.kt)("inlineCode",{parentName:"p"},"UPDATE")," mode:  "),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"If the ",(0,o.kt)("inlineCode",{parentName:"p"},"id")," attribute of the entity object is specified, judge whether it should be ",(0,o.kt)("inlineCode",{parentName:"p"},"INSERT")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"UPDATE")," according to ",(0,o.kt)("inlineCode",{parentName:"p"},"id"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"If the ",(0,o.kt)("inlineCode",{parentName:"p"},"id")," attribute of the entity object is not specified, judge whether it should be ",(0,o.kt)("inlineCode",{parentName:"p"},"INSERT")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"UPDATE")," according to ",(0,o.kt)("inlineCode",{parentName:"p"},"key")," ",(0,o.kt)("em",{parentName:"p"},"(in this case ",(0,o.kt)("inlineCode",{parentName:"em"},"name")," and ",(0,o.kt)("inlineCode",{parentName:"em"},"edition"),")"))))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u2779 Convert entity to DTO  ")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u277a Convert DTO to entity   "))),(0,o.kt)("h3",{id:"write-http-service"},"Write HTTP Service"),(0,o.kt)("p",null,"Since DTO can be converted to entities, you can program like this:  "),(0,o.kt)(i.Z,{groupId:"language",mdxType:"Tabs"},(0,o.kt)(r.Z,{value:"java",label:"Java",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},"BookInput input = ...omitted...; \nsqlClient.save(input.toEntity());\n"))),(0,o.kt)(r.Z,{value:"kotlin",label:"Kotlin",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-kotlin"},"val input: BookInput = ...omitted...\nsqlClient.save(input.toEntity())  \n")))),(0,o.kt)("p",null,"In fact, Jimmer provides a more convenient way, so that even calling the ",(0,o.kt)("inlineCode",{parentName:"p"},"toEntity")," method to convert the DTO to an entity is not necessary, so the code can be simplified to:  "),(0,o.kt)(i.Z,{groupId:"language",mdxType:"Tabs"},(0,o.kt)(r.Z,{value:"java",label:"Java",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},"BookInput input = ...omitted...;\nsqlClient.save(input);\n"))),(0,o.kt)(r.Z,{value:"kotlin",label:"Kotlin",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-kotlin"},"val input: BookInput = ...omitted...  \nsqlClient.save(input) \n")))),(0,o.kt)("p",null,"Next, you can implement the ",(0,o.kt)("inlineCode",{parentName:"p"},"Controller"),":  "),(0,o.kt)(i.Z,{groupId:"language",mdxType:"Tabs"},(0,o.kt)(r.Z,{value:"java",label:"Java",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java",metastring:'title="BookController.java"',title:'"BookController.java"'},'@RestController \npublic class BookController {\n\n    private final JSqlClient sqlClient;  \n\n    public BookController(JSqlClient sqlClient) {\n        this.sqlClient = sqlClient;\n    }\n\n    @PutMapping("/book")  \n    public int saveBook(\n        // highlight-next-line\n        @RequestBody BookInput input  \n    ) {\n        return sqlClient  \n            .save(input)\n            .getTotalAffectedRowCount();\n    }\n}\n'))),(0,o.kt)(r.Z,{value:"kotlin",label:"Kotlin",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-kotlin",metastring:'title="BookController.java"',title:'"BookController.java"'},'class BookController(  \n    private val sqlClient: KSqlClient   \n) {  \n\n    @PutMapping("/book")\n    fun saveBook(\n        // highlight-next-line\n        @RequestBody input: BookInput\n    ): Int =  \n        sqlClient\n            .save(input)\n            .totoalAffectedRowCount  \n}\n')))),(0,o.kt)("h2",{id:"heterogeneous-change-scenario"},"Heterogeneous Change Scenario"),(0,o.kt)("h3",{id:"requirements"},"Requirements"),(0,o.kt)("p",null,"Here we assume that there are two types of book management roles:  "),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Provide two roles that can save books:  "),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Operator: Can only modify the price of existing books  ")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Administrator: Can create and edit all information of books  ")))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"For the Administrator role, the Web API for creating new books and the Web API for editing books need to be separated  "))),(0,o.kt)("h3",{id:"write-dto"},"Write DTO"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh",metastring:'title="Book.dto"',title:'"Book.dto"'},"export com.yourcompany.yourproject.model.Book\n        -> package com.yourcompany.yourproject.model.dto  \n\n/**  \n * Input for the `Operator` role to modify books, can only modify the `price` attribute  \n */\ninput BookOperatorUpdateInput {  \n    id! // Override default behavior, id cannot be null  \n    price  \n}  \n\n/**   \n * Input for the `Administrator` role to create new books, no id attribute  \n */\ninput BookAdministratorCreateInput {   \n    #allScalars(this)\n    -id // Creating new books does not need id  \n}   \n\n/** \n * Input for the `Administrator` role to modify books, id attribute cannot be null \n */\ninput BookAdministratorUpdateInput {   \n    #allScalars(this)\n    id! // Override default behavior, id cannot be null   \n}\n...Omit other DTO definitions...  \n")),(0,o.kt)("h3",{id:"generated-code-1"},"Generated Code"),(0,o.kt)("p",null,"After compilation, the following three types are automatically generated:  "),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"BookOperatorUpdateInput"),"  "),(0,o.kt)(i.Z,{groupId:"language",mdxType:"Tabs"},(0,o.kt)(r.Z,{value:"java",label:"Java",mdxType:"TabItem"},(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-java",metastring:'title="BookOperatorUpdateInput"',title:'"BookOperatorUpdateInput"'},'/**\n * Input for the `Operator` role to modify books, can only modify the `price` attribute\n */\n@GeneratedBy(\n        file = "<yourproject>/src/main/dto/Book.dto"\n)\npublic class BookOperatorUpdateInput implements Input<Book> {  \n\n    private long id;  \n\n    @NotNull\n    private BigDecimal price;  \n\n    ...Omit other methods...\n}\n'))),(0,o.kt)(r.Z,{value:"kotlin",label:"Kotlin",mdxType:"TabItem"},(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-kotlin",metastring:'title="BookOperatorUpdateInput"',title:'"BookOperatorUpdateInput"'},'/**\n * Input for the `Operator` role to modify books, can only modify the `price` attribute  \n */\n@GeneratedBy(\n        file = "<yourproject>/src/main/dto/Book.dto"\n)\ndata class BookOperatorUpdateInput(  \n    val id: Long,\n    val price: BigDecimal\n) : Input<Book> {\n    ...Omit other methods...  \n}\n'))))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"BookAdministratorCreateInput"),"  "),(0,o.kt)(i.Z,{groupId:"language",mdxType:"Tabs"},(0,o.kt)(r.Z,{value:"java",label:"Java",mdxType:"TabItem"},(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-java",metastring:'title="BookAdministratorCreateInput"',title:'"BookAdministratorCreateInput"'},'/**   \n * Input for the `Administrator` role to create new books, no id attribute  \n */\n@GeneratedBy(  \n        file = "<yourproject>/src/main/dto/Book.dto"\n)\npublic class BookAdministratorCreateInput implements Input<Book> {   \n\n    @NotNull\n    private String name;  \n\n    private int edition;  \n\n    @NotNull\n    private BigDecimal price;  \n\n    ...Omit other methods...\n}\n'))),(0,o.kt)(r.Z,{value:"kotlin",label:"Kotlin",mdxType:"TabItem"},(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-kotlin",metastring:'title="BookAdministratorCreateInput"',title:'"BookAdministratorCreateInput"'},'/**   \n * Input for the `Administrator` role to create new books, no id attribute\n */\n@GeneratedBy(\n        file = "<yourproject>/src/main/dto/Book.dto"\n)\ndata class BookAdministratorCreateInput(\n    val name: String,  \n    val edition: Int,\n    val price: BigDecimal\n) : Input<Book> {\n    ...Omit other methods...  \n}\n'))))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"BookAdministratorUpdateInput"),"  "),(0,o.kt)(i.Z,{groupId:"language",mdxType:"Tabs"},(0,o.kt)(r.Z,{value:"java",label:"Java",mdxType:"TabItem"},(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-java",metastring:'title="BookAdministratorUpdateInput"',title:'"BookAdministratorUpdateInput"'},'/**\n * Input for the `Administrator` role to modify books, id attribute cannot be null  \n */\n@GeneratedBy(\n        file = "<yourproject>/src/main/dto/Book.dto"\n)\npublic class BookAdministratorUpdateInput implements Input<Book> {  \n\n    @NotNull\n    private String name;  \n\n    private int edition;\n\n    @NotNull  \n    private BigDecimal price;\n\n    private long id;\n\n    ...Omit other methods...\n}\n'))),(0,o.kt)(r.Z,{value:"kotlin",label:"Kotlin",mdxType:"TabItem"},(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-kotlin",metastring:'title="BookAdministratorUpdateInput"',title:'"BookAdministratorUpdateInput"'},'/**\n * Input for the `Administrator` role to modify books, id attribute cannot be null\n */\n@GeneratedBy(\n        file = "<yourproject>/src/main/dto/Book.dto"\n)\ndata class BookAdministratorUpdateInput(\n    val name: String,\n    val edition: Int,  \n    val price: BigDecimal,\n    val id: Long\n) : Input<Book> {\n    ...Omit other methods...\n}\n')))))),(0,o.kt)("h3",{id:"write-http-service-1"},"Write HTTP Service"),(0,o.kt)(i.Z,{groupId:"language",mdxType:"Tabs"},(0,o.kt)(r.Z,{value:"java",label:"Java",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java",metastring:'title="BookController.java"',title:'"BookController.java"'},'@RestController\npublic class BookController {\n\n    private final JSqlClient sqlClient;  \n\n    public BookController(JSqlClient sqlClient) {\n        this.sqlClient = sqlClient;\n    }  \n\n    // highlight-next-line\n    @Secured("ADMINISTRATOR")\n    @PostMapping("/book")\n    public int createBookByAdministrator(\n        // highlight-next-line\n        @RequestBody BookAdministratorCreateInput input\n    ) {\n        return sqlClient\n            .insert(input) \n            .getTotalAffectedRowCount();\n    }\n\n    // highlight-next-line  \n    @Secured("OPERATOR")\n    @PutMapping("/book/byOperator")\n    public int updateBookByOperator(\n        // highlight-next-line\n        @RequestBody BookOperatorUpdateInput input\n    ) {\n        return sqlClient\n            .update(input)\n            .getTotalAffectedRowCount();\n    }\n\n    // highlight-next-line\n    @Secured("ADMINISTRATOR") \n    @PutMapping("/book")\n    public int updateBookByAdministrator(\n        // highlight-next-line\n        @RequestBody BookAdministratorUpdateInput input\n    ) {\n        return sqlClient\n            .update(input)\n            .getTotalAffectedRowCount();\n    }\n}\n'))),(0,o.kt)(r.Z,{value:"kotlin",label:"Kotlin",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-kotlin",metastring:'title="BookController.java"',title:'"BookController.java"'},'class BookController(  \n    private val sqlClient: KSqlClient  \n) {  \n\n    // highlight-next-line\n    @Secured("ADMINISTRATOR")\n    @PutMapping("/book")\n    fun createBookByAdministrator(\n        // highlight-next-line\n        @RequestBody input: BookAdministratorCreateInput\n    ): Int =\n        sqlClient\n            .insert(input)\n            .totalAffectedRowCount\n\n    // highlight-next-line\n    @Secured("OPERATOR")\n    @PutMapping("/book/byOperator") \n    fun createBookByAdministrator(\n        // highlight-next-line\n        @RequestBody input: BookOperatorUpdateInput\n    ): Int =  \n        sqlClient\n            .update(input)\n            .totalAffectedRowCount\n\n    // highlight-next-line \n    @Secured("ADMINISTRATOR")  \n    @PutMapping("/book/byOperator")\n    fun updateBookByAdministrator(\n        // highlight-next-line\n        @RequestBody input: BookAdministratorUpdateInput\n    ): Int =\n        sqlClient\n            .update(input)\n            .totalAffectedRowCount\n}\n')))),(0,o.kt)("p",null,"It is not difficult to find that no matter how diversified the Input DTO parameters are, Jimmer completes the data saving with one method call."))}c.isMDXComponent=!0}}]);